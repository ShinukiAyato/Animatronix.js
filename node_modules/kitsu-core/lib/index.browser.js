!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).kitsuCore={})}(this,(function(t){"use strict";function e(t){var r;if("object"==typeof t&&null!==t)if(Array.isArray(t))t.map(t=>e(t));else if((null===(r=t.attributes)||void 0===r?void 0:r.constructor)===Object){for(const e of Object.keys(t.attributes))t.attributes.attributes||(t[e]=t.attributes[e]);t.attributes.attributes?t.attributes=t.attributes.attributes:delete t.attributes}return t}function r(t){if(t.response){const e=t.response.data;(null==e?void 0:e.errors)&&(t.errors=e.errors)}throw t}function n(t,{id:e,type:n}){try{if(e&&n){const r=t.filter(t=>t.id===e&&t.type===n)[0]||{id:e,type:n};return Object.assign({},r)}return{}}catch(t){r(t)}}function i({id:t,type:r,meta:i},o){const a=n(o,{id:t,type:r});return a.relationships&&l(a,o),i&&(a.meta=i),e(a)}function o(t,e,r){t[r]={},t.relationships[r].links&&(t[r].links=t.relationships[r].links),t[r].data=[];for(const n of t.relationships[r].data)t[r].data.push(i(n,e));delete t.relationships[r]}function a(t,e,r){t[r]={},t[r].data=i(t.relationships[r].data,e),t.relationships[r].links&&(t[r].links=t.relationships[r].links),delete t.relationships[r]}function s(t,e){t[e]={},t.relationships[e].links&&(t[e].links=t.relationships[e].links),delete t.relationships[e]}function l(t,e=[]){const{relationships:r}=t;for(const i in r){var n;Array.isArray(null===(n=r[i])||void 0===n?void 0:n.data)?o(t,e,i):r[i].data?a(t,e,i):s(t,i)}return 0===Object.keys(r||[]).length&&(null==r?void 0:r.constructor)===Object&&delete t.relationships,t}function u(t,e=null){const r=[];for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&r.push((n=t[o],i=e?"".concat(e,"[").concat(o,"]"):o,null!==n&&"object"==typeof n?u(n,i):encodeURIComponent(i)+"="+encodeURIComponent(n)));var n,i;return r.join("&")}function c(t,e,r,n){const i=new Error("".concat(n," requires an ID for the ").concat(e," type"));if(void 0===e)throw new Error("".concat(n," requires a resource type"));if(t){if("POST"!==n&&r.length>0)for(const t of r)if(!t.id)throw i}else{if((null==r?void 0:r.constructor)!==Object||0===Object.keys(r).length)throw new Error("".concat(n," requires an object or array body"));if("POST"!==n&&!r.id)throw i}}function d(t,e){let r={};for(const e of Object.keys(t))["id","type"].includes(e)?r[e]=t[e]:r=y(t[e],e,r);return r.type||(r.type=e),r}function p(t,e){const r=[];for(const n of t){const t=d(n);t.type||(t.type=e),r.push(t)}return r}function f(t,e,r,n){var i,o;return n.relationships||(n.relationships={}),n.relationships[r]={data:Array.isArray(t.data)?p(t.data,e):d(t.data,e)},((null==t||null===(i=t.links)||void 0===i?void 0:i.self)||(null==t||null===(o=t.links)||void 0===o?void 0:o.related))&&(n.relationships[r].links=t.links),(null==t?void 0:t.meta)&&(n.relationships[r].meta=t.meta),n}function y(t,e,r){return r.attributes||(r.attributes={}),"links"!==e||"string"!=typeof t.self&&"string"!=typeof t.related?"meta"===e&&t.constructor===Object?r.meta=t:r.attributes[e]=t:r.links=t,r}function h(t){if(!t.data)return!1;const e=Array.isArray(t.data)?t.data[0]:t.data;return Object.prototype.hasOwnProperty.call(e,"id")}function b(t,e,r,n){c(!1,t,e,r);let i={type:t=n.pluralTypes(n.camelCaseTypes(t))};(null==e?void 0:e.id)&&(i.id=String(e.id));for(const t in e){const r=e[t],o=n.pluralTypes(n.camelCaseTypes(t));null!==r&&(null==r?void 0:r.constructor)===Object&&h(r)?i=f(r,o,t,i):"id"!==t&&"type"!==t&&(i=y(r,t,i))}return{data:i}}t.camel=t=>t.replace(/[-_][a-z\u00E0-\u00F6\u00F8-\u00FE]/g,t=>t.slice(1).toUpperCase()),t.deattribute=e,t.deserialise=function(t){var r,n;if(t)return Array.isArray(t.data)?t=function(t){for(let r of t.data)t.included&&(r=l(r,t.included)),r.relationships&&(r=l(r)),r.attributes&&(r=e(r)),t.data[t.data.indexOf(r)]=r;return t}(t):t.included?t.data=l(t.data,t.included):(null===(r=t.data)||void 0===r?void 0:r.constructor)===Object&&(t.data=l(t.data)),delete t.included,(null===(n=t.data)||void 0===n?void 0:n.attributes)&&(t.data=e(t.data)),t},t.error=r,t.filterIncludes=n,t.kebab=t=>t.charAt(0).toLowerCase()+t.slice(1).replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,t=>"-"+t.toLowerCase()),t.linkRelationships=l,t.query=u,t.serialise=function(t,e={},n="POST",i={}){try{return i.camelCaseTypes||(i.camelCaseTypes=t=>t),i.pluralTypes||(i.pluralTypes=t=>t),null===e||Array.isArray(e)&&0===e.length?{data:e}:Array.isArray(e)&&(null==e?void 0:e.length)>0?function(t,e,r,n){c(!0,t,e,r);const i=[];for(const o of e)i.push(b(t,o,r,n).data);return{data:i}}(t,e,n,i):b(t,e,n,i)}catch(t){throw r(t)}},t.snake=t=>t.charAt(0).toLowerCase()+t.slice(1).replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,t=>"_"+t.toLowerCase()),t.splitModel=function(t,e={}){e.pluralModel||(e.pluralModel=t=>t),e.resourceCase||(e.resourceCase=t=>t);const r=t.split("/"),n=r.pop();return r.push(e.pluralModel(e.resourceCase(n))),[n,r.join("/")]},Object.defineProperty(t,"__esModule",{value:!0})}));
